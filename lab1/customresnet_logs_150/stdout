PS C:\Users\shama\CV\hw1> .\.venv\Scripts\python.exe .\main.py
Training model with params:
Optim: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    decoupled_weight_decay: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)
Criterion: CrossEntropyLoss()
====================================================================================================
Epoch 1/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:00<00:00, 27.40it/s, Loss=0.591307, Corrects=25/32, Accuracy=78.125%] 
Calculating metrics...
train loss: 0.879594, acc: 0.697421, f05_macro: 0.537310, f1_macro: 0.506575
Confusion matrix:
[[   35    27     5    11     6   131     1     7   218    83    16]
 [    0 10750   741     5     4  1168     0    87    60    64     2]
 [    0  1725  4914     0     6   637     0    32   245    71     2]
 [   15   255    14    73     1   287    17    62    67    20     8]
 [    5   237    68     7    60    79     2     3    82   111    45]
 [   12  2258   603    27     1  4236     0    52  1076   253     4]
 [    1    18     3    10     0    12    39   377     3     1    39]
 [    0   143    10    12     0    49    43  5200     7    13     8]
 [   18   138   144     5     6   965     1    30  4146  1526    11]
 [    2    59    53     3    10   121     1    21  1026  7136    17]
 [    4     7     1     7    12     4    15    36     8    48   458]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:19<00:00,  9.46it/s, Loss=0.519412, Corrects=18/21, Accuracy=85.714%] 
Calculating metrics...
test loss: 0.690344, acc: 0.765950, f05_macro: 0.638572, f1_macro: 0.606744
Confusion matrix:
[[   6    2    1    0    0   12    0    0   33    4    2]
 [   0 1271  117    1    3   35    0    0    4    1    0]
 [   0   91  711    0    2   22    0    2   17    4    0]
 [   0   18    2   20    0   43    1    0    7    0    1]
 [   1   22   23    0    9    8    2    0    2    1   10]
 [   0  173  155    0    0  505    0    0  106    9    0]
 [   0    2    0    2    0    0   33   13    0    0    6]
 [   0   16    1    1    0    2   69  520    0    0    1]
 [   0    4   25    0    0   67    0    0  632   49    0]
 [   0    2    4    1    3    5    0    1  171  752    1]
 [   0    0    0    0    0    0    0    0    0    0   67]]
----------
Epoch Time: 1:20
====================================================================================================
Epoch 2/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [00:59<00:00, 27.91it/s, Loss=0.535460, Corrects=25/32, Accuracy=78.125%] 
Calculating metrics...
train loss: 0.635502, acc: 0.789364, f05_macro: 0.677136, f1_macro: 0.641254
Confusion matrix:
[[  121    11     2    38     4   100     4     1   204    47     8]
 [    2 11445   488    12     8   834     0    33    17    39     2]
 [    0  1047  5857     2    20   463     0    12   187    41     1]
 [   31   210     5   194     2   258    18    34    55     7     4]
 [    9   219    80     8   183    71     2     0    27    68    31]
 [   19  1552   423    67     8  5436     0    16   865   138     0]
 [    2    14     4    13     1     4   113   309     2     1    40]
 [    0    90     2    19     0    19    64  5280     3     4     2]
 [   42    58    88    10     3   725     1    13  5143   908     1]
 [    9    36    30     3    12    44     2    14   682  7614     6]
 [    5     2     1     7    13     2    10     5     0    10   545]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:19<00:00,  9.44it/s, Loss=0.584403, Corrects=18/21, Accuracy=85.714%] 
Calculating metrics...
test loss: 0.551126, acc: 0.817059, f05_macro: 0.699611, f1_macro: 0.639280
Confusion matrix:
[[   6    2    1    0    0   17    0    0   24   10    0]
 [   0 1310   32    1    0   80    0    4    3    2    0]
 [   0  115  679    0    0   34    0    2   11    8    0]
 [   0   15    0   15    0   45    2   10    4    0    1]
 [   0   25   16    0   16   11    0    2    2    1    5]
 [   0  148   49    0    0  678    0    2   62    9    0]
 [   0    2    0    0    0    0   10   43    0    0    1]
 [   0    6    0    0    0    0    2  602    0    0    0]
 [   0    5   14    0    0   97    0    2  607   52    0]
 [   1    3    2    0    1    3    0    1   91  838    0]
 [   0    0    0    0    0    0    0    0    0    0   67]]
----------
Epoch Time: 1:19
====================================================================================================
Epoch 3/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:04<00:00, 25.92it/s, Loss=0.541065, Corrects=27/32, Accuracy=84.375%] 
Calculating metrics...
train loss: 0.563308, acc: 0.813799, f05_macro: 0.717529, f1_macro: 0.683756
Confusion matrix:
[[  172     6     1    52     2    75     0     2   180    43     7]
 [    1 11607   407    15     9   754     0    27    22    35     2]
 [    0   926  6033     0    24   430     1     8   172    39     0]
 [   36   185     4   262     0   237    22    25    37     8     2]
 [   12   183    96    13   213    71     0     1    29    48    33]
 [   24  1352   367    73    11  5813     0    10   744   126     0]
 [    4    12     1    17     0     5   154   279     3     0    28]
 [    1    73     5    10     0    14    65  5310     2     4     1]
 [   48    47    76    10     6   637     1    14  5412   739     0]
 [   12    29    23     0     7    41     2    10   614  7714     2]
 [    4     5     1     8    17     1    11     2     2     9   539]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:23<00:00,  7.98it/s, Loss=0.400633, Corrects=18/21, Accuracy=85.714%] 
Calculating metrics...
test loss: 0.514383, acc: 0.834321, f05_macro: 0.732761, f1_macro: 0.712684
Confusion matrix:
[[  26    1    1    9    0    2    2    1   12    4    2]
 [   1 1264   79    1    2   79    0    1    3    2    0]
 [   0   60  710    0    4   44    0    2   22    7    0]
 [   4   11    0   39    0   20    8    5    4    1    0]
 [   1    8   21    0   14   18    1    1    1    2   11]
 [   5   77   52    5    3  648    0    1  146   11    0]
 [   0    1    0    0    0    1   29   25    0    0    0]
 [   0    6    1    1    0    1    5  596    0    0    0]
 [   7    3    4    1    0   33    0    0  645   84    0]
 [   1    2    4    0    0    1    1    1   35  894    1]
 [   0    0    0    0    0    0    2    0    0    0   65]]
----------
Epoch Time: 1:27
====================================================================================================
Epoch 4/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:15<00:00, 22.10it/s, Loss=0.203172, Corrects=31/32, Accuracy=96.875%] 
Calculating metrics...
train loss: 0.513108, acc: 0.831947, f05_macro: 0.744753, f1_macro: 0.714317
Confusion matrix:
[[  200     8     3    43     4    83     1     2   144    46     5]
 [    0 11768   357    21    12   646     1    27    22    24     1]
 [    1   831  6193     0    29   392     2     8   146    31     0]
 [   49   179     5   293     0   215    19    17    32     9     1]
 [   14   163    95    12   261    67     1     0    25    35    26]
 [   28  1200   343    69     8  6071     0     4   686   115     0]
 [    2    16     0    21     0     1   186   253     0     0    24]
 [    0    62     5    14     0    14    75  5307     2     5     1]
 [   50    42    73     7     4   587     0    11  5556   660     2]
 [   10    18    20     1     8    39     1    10   530  7805     5]
 [    4     2     2    10    12     0     7     1     1     8   553]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:22<00:00,  8.15it/s, Loss=0.363743, Corrects=19/21, Accuracy=90.476%] 
Calculating metrics...
test loss: 0.469603, acc: 0.857336, f05_macro: 0.794887, f1_macro: 0.758295
Confusion matrix:
[[  25    2    1    5    2    7    0    0   15    2    1]
 [   0 1332   71    1    0   22    0    1    2    3    0]
 [   0   51  754    0    4   24    0    2    7    7    0]
 [   2   15    0   42    0   21    4    2    4    1    1]
 [   1   20   18    0   26    8    0    2    1    1    1]
 [   1  129   61    2    2  683    0    0   59   11    0]
 [   0    1    0    0    0    1   27   26    0    0    1]
 [   0    4    1    2    0    0    4  599    0    0    0]
 [   3    6    4    1    0   85    0    0  633   45    0]
 [   2    4    1    0    1    4    0    1   48  879    0]
 [   0    0    0    0    1    0    0    0    0    0   66]]
----------
Epoch Time: 1:38
====================================================================================================
Epoch 5/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:12<00:00, 22.75it/s, Loss=0.571776, Corrects=27/32, Accuracy=84.375%] 
Calculating metrics...
train loss: 0.476932, acc: 0.843675, f05_macro: 0.762974, f1_macro: 0.734999
Confusion matrix:
[[  230     8     3    50     8    66     1     1   137    32     4]
 [    0 11802   355    19    17   615     2    26    16    28     1]
 [    0   761  6279     1    24   374     1     6   138    47     2]
 [   48   169     2   323     4   198    16    18    34     3     4]
 [   13   150    77    11   297    70     1     0    22    36    22]
 [   23  1101   321    70    20  6233     0     4   642   108     0]
 [    1    13     0    23     0     5   198   241     0     0    22]
 [    0    58     5    10     0     8    71  5321     3     5     1]
 [   44    31    57    10     5   550     1    10  5702   579     1]
 [   11    17    28     0     6    35     0     8   465  7878     3]
 [    6     2     1     9     9     1    11     0     2     6   553]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:20<00:00,  9.11it/s, Loss=0.499862, Corrects=18/21, Accuracy=85.714%] 
Calculating metrics...
test loss: 0.452666, acc: 0.852428, f05_macro: 0.777896, f1_macro: 0.755189
Confusion matrix:
[[  23    2    1    9    0    4    0    0   14    6    1]
 [   1 1379   28    7    0   13    0    1    1    2    0]
 [   0   93  713    0    2   19    0    2   16    4    0]
 [   3    9    0   60    0   12    2    0    4    1    1]
 [   0   24   14    2   18    8    2    0    1    1    8]
 [   3  183   25   14    0  633    0    0   82    8    0]
 [   0    1    0    0    0    1   39   15    0    0    0]
 [   0    5    1    5    0    0   11  588    0    0    0]
 [   5    4    7    0    0   54    0    0  671   36    0]
 [   2    3    1    0    1    2    0    0   85  846    0]
 [   0    0    0    0    0    0    0    0    0    0   67]]
----------
Epoch Time: 1:33
====================================================================================================
Epoch 6/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:03<00:00, 26.20it/s, Loss=0.554951, Corrects=25/32, Accuracy=78.125%] 
Calculating metrics...
train loss: 0.446387, acc: 0.854085, f05_macro: 0.777333, f1_macro: 0.751108
Confusion matrix:
[[  242     6     2    59     5    60     0     2   131    31     2]
 [    0 11913   316    18    18   543     1    25    16    28     3]
 [    0   722  6379     0    24   345     2     6   126    27     0]
 [   45   168     3   342     2   186    14    16    32     6     5]
 [   12   132    78    12   337    58     1     0    22    23    24]
 [   26   999   324    69    11  6358     2     4   627   102     0]
 [    1    12     0    23     0     3   208   231     2     0    22]
 [    0    55     3    15     0    11    76  5315     0     5     1]
 [   40    33    59    12     4   526     2     9  5790   516     2]
 [    9    19    18     0    11    26     0    10   431  7926     2]
 [    3     1     2    14     9     1     5     1     1     4   559]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:19<00:00,  9.29it/s, Loss=0.525860, Corrects=18/21, Accuracy=85.714%] 
Calculating metrics...
test loss: 0.551230, acc: 0.804705, f05_macro: 0.757273, f1_macro: 0.748157
Confusion matrix:
[[  28    1    1   16    0    5    0    0    9    0    0]
 [   2 1243   27   18    2  136    0    0    4    0    0]
 [   0   70  674    0    9   72    0    2   21    1    0]
 [   2    5    0   75    0    8    0    0    1    0    1]
 [   0   13    8    3   40    8    2    0    2    0    2]
 [   2   55   23   29    1  764    0    0   72    2    0]
 [   0    0    0    2    0    1   35   17    0    0    1]
 [   0    0    1   13    0    0   17  579    0    0    0]
 [   7    4    1    4    0   81    0    0  673    7    0]
 [   6    5    0    0    1    5    0    1  344  578    0]
 [   0    0    0    0    1    0    0    0    0    0   66]]
----------
Epoch Time: 1:23
====================================================================================================
Epoch 7/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:00<00:00, 27.41it/s, Loss=0.449824, Corrects=25/32, Accuracy=78.125%] 
Calculating metrics...
train loss: 0.422284, acc: 0.862406, f05_macro: 0.796652, f1_macro: 0.772838
Confusion matrix:
[[  271     9     2    40     3    68     0     2   115    26     4]
 [    0 11937   314    18    19   528     3    19    15    23     2]
 [    0   636  6443     1    27   359     2     6   129    30     0]
 [   40   144     1   393     3   175    12    17    28     4     2]
 [    9   124    60    11   363    60     1     0    24    25    22]
 [   25   966   292    55    18  6471     0     4   594    99     0]
 [    0    13     0    17     0     4   242   209     0     0    18]
 [    1    50     3    15     0     6    83  5319     1     5     1]
 [   43    29    58    10     8   513     1     6  5864   459     0]
 [   10    20    17     0     8    27     1     7   399  7957     3]
 [    2     2     1    11    15     1     7     1     2     7   551]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:19<00:00,  9.30it/s, Loss=0.261869, Corrects=18/21, Accuracy=85.714%] 
Calculating metrics...
test loss: 0.403182, acc: 0.869183, f05_macro: 0.793731, f1_macro: 0.786667
Confusion matrix:
[[  38    2    1    6    0    1    0    0    7    2    3]
 [   1 1386   10    7    1   21    0    2    2    2    0]
 [   0   69  730    0    2   28    0    1   17    2    0]
 [  10   10    0   62    0    5    2    0    1    1    1]
 [   0   15   12    4   32    5    2    0    2    1    5]
 [   8  121   47   19    3  647    0    0   95    8    0]
 [   0    1    0    0    0    1   38   15    0    0    1]
 [   0    3    1    3    0    0   14  589    0    0    0]
 [  14    5    3    1    0   34    0    0  693   27    0]
 [   1    3    0    0    0    0    1    1   80  854    0]
 [   0    0    0    0    0    0    0    0    0    0   67]]
----------
Epoch Time: 1:20
====================================================================================================
Epoch 8/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [00:59<00:00, 27.76it/s, Loss=0.492182, Corrects=27/32, Accuracy=84.375%] 
Calculating metrics...
train loss: 0.398066, acc: 0.868957, f05_macro: 0.803562, f1_macro: 0.781914
Confusion matrix:
[[  274     7     1    41     5    57     0     1   117    33     4]
 [    0 12021   286    21    22   474     2    15    14    25     0]
 [    0   644  6492     0    24   315     0     7   117    27     1]
 [   44   145     2   403     2   165    12    14    22     5     4]
 [   14   114    57    12   380    59     2     0    16    28    17]
 [   23   897   284    71    11  6525     0    10   594   109     0]
 [    0    12     0    22     0     3   262   185     0     0    19]
 [    0    36     1    17     0     9    70  5342     1     7     1]
 [   56    26    54     8     6   479     1    10  5907   443     2]
 [   12    18    19     0     9    27     0     6   360  7999     3]
 [    3     0     1    11    14     3     9     0     2     3   554]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:19<00:00,  9.47it/s, Loss=0.385951, Corrects=18/21, Accuracy=85.714%] 
Calculating metrics...
test loss: 0.398794, acc: 0.870536, f05_macro: 0.816866, f1_macro: 0.788133
Confusion matrix:
[[  27    2    1   11    0    8    0    0   10    1    0]
 [   1 1290    5    3    0  128    0    1    2    2    0]
 [   0   74  670    0    3   81    0    2   12    7    0]
 [   5    6    0   62    0   15    0    2    2    0    0]
 [   0   10    6    3   36   13    2    0    1    1    6]
 [   1   50   12   10    2  816    0    0   47   10    0]
 [   0    1    0    0    0    1   27   27    0    0    0]
 [   0    2    0    2    0    1    2  603    0    0    0]
 [   3    3    3    0    0   72    0    0  642   54    0]
 [   1    2    0    1    0    4    0    1   24  907    0]
 [   0    0    0    0    0    0    3    0    0    0   64]]
----------
Epoch Time: 1:19
====================================================================================================
Epoch 9/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [00:59<00:00, 27.73it/s, Loss=0.416662, Corrects=27/32, Accuracy=84.375%] 
Calculating metrics...
train loss: 0.378719, acc: 0.876130, f05_macro: 0.816139, f1_macro: 0.795600
Confusion matrix:
[[  282     4     3    49     2    56     2     1   114    25     2]
 [    0 12072   280    14    15   445     1    15    17    21     2]
 [    0   608  6516     0    25   330     1     5   114    29     1]
 [   47   136     1   439     3   146     9    13    16     7     2]
 [   14    88    56    10   419    56     0     0    18    22    16]
 [   26   857   275    67    19  6624     0     6   547   104     0]
 [    0    13     1    14     0     4   263   187     0     0    21]
 [    0    40     3    19     1     4    74  5336     2     3     1]
 [   48    29    46     5     2   441     1     7  6007   403     1]
 [    9    18    18     0     8    27     0     8   336  8023     3]
 [    2     2     2    10    12     1     5     1     1     5   559]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:19<00:00,  9.40it/s, Loss=0.540882, Corrects=18/21, Accuracy=85.714%] 
Calculating metrics...
test loss: 0.415742, acc: 0.862921, f05_macro: 0.810913, f1_macro: 0.793933
Confusion matrix:
[[  22    1    1   14    0    8    0    0   13    1    0]
 [   0 1238   39   17    2  131    0    2    2    1    0]
 [   0   44  753    0    3   37    0    2    7    3    0]
 [   1    3    0   65    0   19    0    2    2    0    0]
 [   0    8   11    1   39   16    2    0    1    0    0]
 [   1   53   31   11    1  800    0    0   43    8    0]
 [   0    1    0    0    0    1   41   12    0    0    1]
 [   0    2    1    3    0    0    7  597    0    0    0]
 [   3    3   19    1    0   92    0    0  633   26    0]
 [   2    5    7    1    8    5    0    0   66  846    0]
 [   0    0    0    0    2    0    0    0    0    0   65]]
----------
Epoch Time: 1:19
====================================================================================================
Epoch 10/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:07<00:00, 24.46it/s, Loss=0.293842, Corrects=28/32, Accuracy=87.500%] 
Calculating metrics...
train loss: 0.358516, acc: 0.883321, f05_macro: 0.830692, f1_macro: 0.812872
Confusion matrix:
[[  316     6     1    41     7    54     0     1    92    22     0]
 [    0 12089   259    16    19   447     3    14    11    23     0]
 [    0   557  6599     1    27   314     0     5   105    20     1]
 [   52   132     2   441     3   143     7    13    21     5     0]
 [   11    72    53    10   451    54     1     0    12    17    18]
 [   26   789   253    62    18  6725     0     3   551    97     0]
 [    3    10     0    15     0     3   295   159     0     0    18]
 [    0    37     2    16     0     4    65  5349     4     4     1]
 [   42    22    44     8     1   432     1     8  6038   395     0]
 [    9    22    19     1     7    27     0     7   301  8055     4]
 [    1     2     1    10    10     1     7     1     1     2   564]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:20<00:00,  9.01it/s, Loss=0.363883, Corrects=20/21, Accuracy=95.238%] 
Calculating metrics...
test loss: 0.372524, acc: 0.881706, f05_macro: 0.821451, f1_macro: 0.804778
Confusion matrix:
[[  24    2    1   10    0    5    0    0   16    2    0]
 [   0 1311   21    8    0   87    0    0    3    2    0]
 [   0   46  737    0    2   50    0    1    7    6    0]
 [   2    4    0   69    0   13    0    0    4    0    0]
 [   1    8   16    0   36   11    2    0    1    1    2]
 [   1   61   21   10    1  779    0    0   65   10    0]
 [   0    1    0    1    0    1   45    8    0    0    0]
 [   0    1    1    6    0    0   23  579    0    0    0]
 [   4    3    8    0    0   67    0    0  654   41    0]
 [   2    3    2    0    0    2    0    0   19  912    0]
 [   0    0    0    0    0    0    3    0    0    0   64]]
----------
Epoch Time: 1:28
*** Training Completed ***

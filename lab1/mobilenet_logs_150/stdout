PS C:\Users\shama\CV\hw1> .\.venv\Scripts\python.exe .\main.py
Downloading: "https://download.pytorch.org/models/mobilenet_v2-b0353104.pth" to C:\Users\shama/.cache\torch\hub\checkpoints\mobilenet_v2-b0353104.pth
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13.6M/13.6M [00:00<00:00, 22.4MB/s]
Training model with params:
Optim: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    decoupled_weight_decay: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)
Criterion: CrossEntropyLoss()
====================================================================================================
Epoch 1/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:06<00:00, 24.78it/s, Loss=0.543187, Corrects=28/32, Accuracy=87.500%] 
Calculating metrics...
train loss: 0.683418, acc: 0.770200, f05_macro: 0.676478, f1_macro: 0.646672
Confusion matrix:
[[  145    12     4    62     2    98     0     1   169    40     7]
 [    1 11181   534    34    12  1006     3    29    48    32     2]
 [    0  1242  5523     5    23   541     1    15   228    54     1]
 [   53   202     7   257     1   201    16    14    63     2     3]
 [   14   148   117     7   215    97     3     2    35    37    24]
 [   24  1613   505    50    16  5200     2    19   944   149     1]
 [    0    19     4    19     1     3   134   274     5     5    38]
 [    0    68     8     9     2    17    83  5280     9     5     3]
 [   45    64   128    17    12   856     1    18  4965   880     2]
 [   19    24    40     2    13    55     4    12   798  7478     5]
 [    4     5     2    14    13     0    12     3     3     9   535]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:21<00:00,  8.69it/s, Loss=0.375694, Corrects=19/21, Accuracy=90.476%] 
Calculating metrics...
test loss: 0.582399, acc: 0.805212, f05_macro: 0.746332, f1_macro: 0.697681
Confusion matrix:
[[  16    0    0    4    0    1    0    0   34    5    0]
 [   0 1150  219    3    1   50    0    1    2    5    1]
 [   0   26  791    0    0    9    0    0   17    6    0]
 [   6   22    5   31    0    8    2    2   16    0    0]
 [   0    6   33    0   26    4    0    0    2    5    2]
 [   0   81  129    2    1  466    0    0  253   16    0]
 [   0    3    3    3    0    0   23   23    0    0    1]
 [   0    5    0    2    0    0    4  599    0    0    0]
 [   0    0   10    0    1    6    0    2  682   76    0]
 [   0    2    2    0    0    0    0    1   22  911    2]
 [   0    0    0    1    0    0    2    0    0    1   63]]
----------
Epoch Time: 1:28
====================================================================================================
Epoch 2/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:09<00:00, 23.91it/s, Loss=0.546591, Corrects=25/32, Accuracy=78.125%] 
Calculating metrics...
train loss: 0.533066, acc: 0.823362, f05_macro: 0.749505, f1_macro: 0.725455
Confusion matrix:
[[  211     9     3    68     3    88     0     2   117    33     6]
 [    1 11586   404    26    22   774     4    23    21    20     0]
 [    0   987  5927     3    32   471     0     7   164    36     1]
 [   66   167     6   324     0   194    17    11    25     5     4]
 [   12   114    94     5   335    65     1     2    28    21    22]
 [   0    6   33    0   26    4    0    0    2    5    2]
 [   0   81  129    2    1  466    0    0  253   16    0]
 [   0    3    3    3    0    0   23   23    0    0    1]
 [   0    5    0    2    0    0    4  599    0    0    0]
 [   0    0   10    0    1    6    0    2  682   76    0]
 [   0    2    2    0    0    0    0    1   22  911    2]
 [   0    0    0    1    0    0    2    0    0    1   63]]
----------
Epoch Time: 1:28
====================================================================================================
Epoch 2/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:09<00:00, 23.91it/s, Loss=0.546591, Corrects=25/32, Accuracy=78.125%] 
Calculating metrics...
train loss: 0.533066, acc: 0.823362, f05_macro: 0.749505, f1_macro: 0.725455
Confusion matrix:
[[  211     9     3    68     3    88     0     2   117    33     6]
 [    1 11586   404    26    22   774     4    23    21    20     0]
 [    0   987  5927     3    32   471     0     7   164    36     1]
 [   66   167     6   324     0   194    17    11    25     5     4]
 [   12   114    94     5   335    65     1     2    28    21    22]
 [   0   81  129    2    1  466    0    0  253   16    0]
 [   0    3    3    3    0    0   23   23    0    0    1]
 [   0    5    0    2    0    0    4  599    0    0    0]
 [   0    0   10    0    1    6    0    2  682   76    0]
 [   0    2    2    0    0    0    0    1   22  911    2]
 [   0    0    0    1    0    0    2    0    0    1   63]]
----------
Epoch Time: 1:28
====================================================================================================
Epoch 2/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:09<00:00, 23.91it/s, Loss=0.546591, Corrects=25/32, Accuracy=78.125%] 
Calculating metrics...
train loss: 0.533066, acc: 0.823362, f05_macro: 0.749505, f1_macro: 0.725455
Confusion matrix:
[[  211     9     3    68     3    88     0     2   117    33     6]
 [    1 11586   404    26    22   774     4    23    21    20     0]
 [    0   987  5927     3    32   471     0     7   164    36     1]
 [   66   167     6   324     0   194    17    11    25     5     4]
 [   12   114    94     5   335    65     1     2    28    21    22]
 [   0    5    0    2    0    0    4  599    0    0    0]
 [   0    0   10    0    1    6    0    2  682   76    0]
 [   0    2    2    0    0    0    0    1   22  911    2]
 [   0    0    0    1    0    0    2    0    0    1   63]]
----------
Epoch Time: 1:28
====================================================================================================
Epoch 2/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:09<00:00, 23.91it/s, Loss=0.546591, Corrects=25/32, Accuracy=78.125%] 
Calculating metrics...
train loss: 0.533066, acc: 0.823362, f05_macro: 0.749505, f1_macro: 0.725455
Confusion matrix:
[[  211     9     3    68     3    88     0     2   117    33     6]
 [    1 11586   404    26    22   774     4    23    21    20     0]
 [    0   987  5927     3    32   471     0     7   164    36     1]
 [   66   167     6   324     0   194    17    11    25     5     4]
 [   12   114    94     5   335    65     1     2    28    21    22]
 [   0    0   10    0    1    6    0    2  682   76    0]
 [   0    2    2    0    0    0    0    1   22  911    2]
 [   0    0    0    1    0    0    2    0    0    1   63]]
----------
Epoch Time: 1:28
====================================================================================================
Epoch 2/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:09<00:00, 23.91it/s, Loss=0.546591, Corrects=25/32, Accuracy=78.125%] 
Calculating metrics...
train loss: 0.533066, acc: 0.823362, f05_macro: 0.749505, f1_macro: 0.725455
Confusion matrix:
[[  211     9     3    68     3    88     0     2   117    33     6]
 [    1 11586   404    26    22   774     4    23    21    20     0]
 [    0   987  5927     3    32   471     0     7   164    36     1]
 [   66   167     6   324     0   194    17    11    25     5     4]
 [   12   114    94     5   335    65     1     2    28    21    22]
Epoch Time: 1:28
====================================================================================================
Epoch 2/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:09<00:00, 23.91it/s, Loss=0.546591, Corrects=25/32, Accuracy=78.125%] 
Calculating metrics...
train loss: 0.533066, acc: 0.823362, f05_macro: 0.749505, f1_macro: 0.725455
Confusion matrix:
[[  211     9     3    68     3    88     0     2   117    33     6]
 [    1 11586   404    26    22   774     4    23    21    20     0]
 [    0   987  5927     3    32   471     0     7   164    36     1]
 [   66   167     6   324     0   194    17    11    25     5     4]
 [   12   114    94     5   335    65     1     2    28    21    22]
Epoch 2/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:09<00:00, 23.91it/s, Loss=0.546591, Corrects=25/32, Accuracy=78.125%] 
Calculating metrics...
train loss: 0.533066, acc: 0.823362, f05_macro: 0.749505, f1_macro: 0.725455
Confusion matrix:
[[  211     9     3    68     3    88     0     2   117    33     6]
 [    1 11586   404    26    22   774     4    23    21    20     0]
 [    0   987  5927     3    32   471     0     7   164    36     1]
 [   66   167     6   324     0   194    17    11    25     5     4]
 [   12   114    94     5   335    65     1     2    28    21    22]
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:09<00:00, 23.91it/s, Loss=0.546591, Corrects=25/32, Accuracy=78.125%] 
Calculating metrics...
train loss: 0.533066, acc: 0.823362, f05_macro: 0.749505, f1_macro: 0.725455
Confusion matrix:
[[  211     9     3    68     3    88     0     2   117    33     6]
 [    1 11586   404    26    22   774     4    23    21    20     0]
 [    0   987  5927     3    32   471     0     7   164    36     1]
 [   66   167     6   324     0   194    17    11    25     5     4]
 [   12   114    94     5   335    65     1     2    28    21    22]
[[  211     9     3    68     3    88     0     2   117    33     6]
 [    1 11586   404    26    22   774     4    23    21    20     0]
 [    0   987  5927     3    32   471     0     7   164    36     1]
 [   66   167     6   324     0   194    17    11    25     5     4]
 [   12   114    94     5   335    65     1     2    28    21    22]
 [   25  1270   379    64    26  5878     2     4   760   116     0]
 [    0    14     1    17     1     2   217   221     0     4    26]
 [    0    44     6    11     0    11    83  5318     3     6     1]
 [   66   167     6   324     0   194    17    11    25     5     4]
 [   12   114    94     5   335    65     1     2    28    21    22]
 [   25  1270   379    64    26  5878     2     4   760   116     0]
 [    0    14     1    17     1     2   217   221     0     4    26]
 [    0    44     6    11     0    11    83  5318     3     6     1]
 [   39    44    90     8     6   606     0     8  5566   621     2]
 [   17    20    27     0     9    31     0    10   511  7821     7]
 [   25  1270   379    64    26  5878     2     4   760   116     0]
 [    0    14     1    17     1     2   217   221     0     4    26]
 [    0    44     6    11     0    11    83  5318     3     6     1]
 [   39    44    90     8     6   606     0     8  5566   621     2]
 [   17    20    27     0     9    31     0    10   511  7821     7]
 [    5     2     1     6    11     1    11     2     3     4   554]]
 [   39    44    90     8     6   606     0     8  5566   621     2]
 [   17    20    27     0     9    31     0    10   511  7821     7]
 [    5     2     1     6    11     1    11     2     3     4   554]]
 [    5     2     1     6    11     1    11     2     3     4   554]]
--- Cur phase: test
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:21<00:00,  8.63it/s, Loss=0.369020, Corrects=17/21, Accuracy=80.952%] 
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:21<00:00,  8.63it/s, Loss=0.369020, Corrects=17/21, Accuracy=80.952%] 
Calculating metrics...
Calculating metrics...
test loss: 0.453193, acc: 0.858013, f05_macro: 0.785163, f1_macro: 0.769875
Confusion matrix:
[[  35    0    0    7    0    3    0    0   12    3    0]
 [   1 1332   45    3    5   39    0    1    4    2    0]
 [   0   72  734    1    6   20    0    1   13    2    0]
 [   6   25    0   39    0   12    1    2    6    0    1]
 [   2   11   10    1   47    5    0    0    0    1    1]
 [   7  146   39   21    2  650    0    0   73   10    0]
 [   1    4    0    2    0    0   28   18    0    0    3]
 [   0    6    0    2    0    1    5  596    0    0    0]
 [  10    0    7    2    1   53    0    2  683   19    0]
 [   1    2    0    0    0    1    0    2   69  865    0]
 [   1    0    0    2    0    0    1    0    0    2   61]]
----------
Epoch Time: 1:31
====================================================================================================
Epoch 3/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:12<00:00, 22.92it/s, Loss=0.453619, Corrects=28/32, Accuracy=87.500%] 
Calculating metrics...
train loss: 0.491612, acc: 0.836126, f05_macro: 0.768710, f1_macro: 0.746007
Confusion matrix:
[[  215     6     3    71     1    71     2     1   128    38     3]
 [    1 11713   384    23    19   674     1    21    15    29     0]
 [    0   950  6049     3    29   403     0     7   152    36     1]
 [   60   146     1   352     0   185    15    18    38     1     2]
 [   11    94    79     4   382    70     3     0    16    21    19]
 [   24  1170   351    76    23  6050     0     7   710   115     0]
 [    1    11     0    17     0     4   242   202     4     1    21]
 [    0    49     6    11     2     6    80  5320     2     7     1]
 [   52    37    80     9     6   602     2    10  5644   547     0]
 [    5    17    23     0     8    32     1     6   463  7895     2]
 [    3     2     1     8    12     1    13     1     2     4   553]]
--- Cur phase: test
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:22<00:00,  8.37it/s, Loss=0.242938, Corrects=21/21, Accuracy=100.000%] 
Calculating metrics...
test loss: 0.431663, acc: 0.860890, f05_macro: 0.787062, f1_macro: 0.780017
Confusion matrix:
[[  40    0    0    2    0    4    0    0   11    3    0]
 [   1 1224   35    2    8  156    0    1    3    2    0]
 [   0   48  735    0    3   44    0    1   16    2    0]
 [   9   16    2   35    0   21    2    0    7    0    0]
 [   0    4    6    0   53    9    0    0    0    4    2]
 [   5   52   31    3    3  766    0    0   78   10    0]
 [   0    1    0    2    0    4   34   10    0    0    5]
 [   0    4    1    1    0    3   31  569    0    1    0]
 [   8    0    9    0    1   38    1    1  692   27    0]
 [   5    2    2    0    1    2    0    2   50  876    0]
 [   0    0    0    2    0    0    1    0    0    1   63]]
----------
Epoch Time: 1:35
====================================================================================================
Epoch 4/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:10<00:00, 23.46it/s, Loss=0.209043, Corrects=31/32, Accuracy=96.875%] 
Calculating metrics...
train loss: 0.455460, acc: 0.851224, f05_macro: 0.789088, f1_macro: 0.767809
Confusion matrix:
[[  248     6     3    65     2    55     0     2   121    33     5]
 [    2 11805   365    25    25   600     2    19    16    20     0]
 [    0   880  6175     2    30   363     0     5   143    34     0]
 [   53   156     2   373     0   169    15    10    37     3     1]
 [   12   102    71     5   400    55     2     1    23    12    15]
 [   29  1049   313    86    12  6290     0     4   628   112     0]
 [    0    13     0    16     0     5   264   177     1     0    27]
 [    0    42     4    10     2     9    75  5333     3     5     1]
 [   47    32    70    12     3   528     1     9  5817   471     1]
 [    4    18    22     1     4    20     1     9   418  7953     1]
 [    6     2     1     7     5     1    12     0     2     5   559]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:20<00:00,  8.82it/s, Loss=0.318239, Corrects=17/21, Accuracy=80.952%] 
Calculating metrics...
test loss: 0.415156, acc: 0.867321, f05_macro: 0.811513, f1_macro: 0.786220
Confusion matrix:
[[  36    0    0    7    0    3    0    0   11    3    0]
 [   1 1350   52    1    2   22    0    0    2    2    0]
 [   0   70  746    0    0   12    0    1   18    2    0]
 [   7   22    0   42    0   15    3    1    2    0    0]
 [   2   10   12    1   41    4    0    0    1    7    0]
 [   7  132   60    9    0  664    0    0   65   11    0]
 [   0    4    0    3    0    0   31   17    0    0    1]
 [   0    8    0    1    0    0    2  599    0    0    0]
 [  10    2    5    3    0   48    1    2  643   63    0]
 [   2    3    1    0    0    0    0    2   20  912    0]
 [   2    0    0    2    0    0    1    0    0    1   61]]
----------
Epoch Time: 1:32
====================================================================================================
Epoch 5/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:12<00:00, 22.80it/s, Loss=0.361194, Corrects=29/32, Accuracy=90.625%] 
Calculating metrics...
train loss: 0.437342, acc: 0.856815, f05_macro: 0.801207, f1_macro: 0.780075
Confusion matrix:
[[  267     6     3    57     1    53     0     1   123    26     3]
 [    1 11832   344    23    15   609     1    26    12    17     1]
 [    0   850  6224     1    32   369     1     7   119    29     0]
 [   51   136     6   399     0   162    13    14    33     2     2]
 [   10    99    62     4   414    56     3     0    19    16    16]
 [   27  1018   283    61    19  6340     1     5   663   107     0]
 [    0    12     1    16     0     3   273   177     1     2    18]
 [    0    38     6    17     0     4    76  5334     3     5     1]
 [   44    28    71     8     2   507     0     7  5884   438     0]
 [   10    22    19     0     5    17     0     7   377  7989     4]
 [    5     2     1    11     9     1     9     0     1     3   558]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:21<00:00,  8.64it/s, Loss=0.222791, Corrects=20/21, Accuracy=95.238%] 
Calculating metrics...
test loss: 0.436086, acc: 0.854459, f05_macro: 0.805419, f1_macro: 0.773716
Confusion matrix:
[[  29    0    0    2    0    5    0    0   19    5    0]
 [   0 1145   45    3    4  225    2    1    4    2    1]
 [   0   39  753    0    0   42    0    1   12    2    0]
 [   5   12    2   32    0   24    5    2   10    0    0]
 [   0    6    7    0   47   14    0    0    0    2    2]
 [   3   41   31    1    0  770    0    1   97    4    0]
 [   0    1    0    2    0    2   26   24    0    0    1]
 [   0    4    0    1    0    1    1  603    0    0    0]
 [   3    1    8    0    1   27    2    1  714   20    0]
 [   0    2    2    0    0    1    0    2   66  867    0]
 [   0    0    0    0    0    0    3    0    0    1   63]]
----------
Epoch Time: 1:34
====================================================================================================
Epoch 6/10
----------
--- Cur phase: train
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:09<00:00, 23.98it/s, Loss=0.150861, Corrects=32/32, Accuracy=100.000%]
Calculating metrics...
train loss: 0.421320, acc: 0.860410, f05_macro: 0.805684, f1_macro: 0.786691
Confusion matrix:
[[  283     5     4    52     2    53     0     2   112    26     1]
 [    0 11869   334    26    20   570     3    23    13    22     0]
 [    0   849  6248     3    28   330     1     7   129    36     0]
 [   59   142     3   396     2   163    14    10    25     3     2]
 [   12    89    71     4   427    50     3     0    11    16    16]
 [   25   949   326    77    11  6400     0     5   634    97     0]
 [    1    12     0    15     0     4   289   159     2     0    21]
 [    0    35     4    13     1     8    66  5345     2     8     1]
 [   51    35    62    10     5   504     1     6  5883   434     0]
 [   10    17    24     0     7    26     0     6   353  8005     2]
 [    3     2     1     7     9     1    12     1     2     2   560]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:21<00:00,  8.63it/s, Loss=0.370313, Corrects=17/21, Accuracy=80.952%] 
Calculating metrics...
test loss: 0.403389, acc: 0.865798, f05_macro: 0.806370, f1_macro: 0.775902
Confusion matrix:
[[  27    0    0    4    1    3    0    0   18    6    1]
 [   0 1264   18    4    1  136    0    0    2    5    2]
 [   0   72  711    0    0   42    0    1   19    4    0]
 [   3   16    0   36    0   21    6    0    9    0    1]
 [   0   10    5    0   43   12    0    0    0    6    2]
 [   2   64   18    6    1  729    0    0  118   10    0]
 [   0    2    0    1    0    2   30   12    0    0    9]
 [   0    5    0    0    0    3    3  599    0    0    0]
 [   1    0    4    0    1   23    1    1  704   42    0]
 [   0    2    0    0    0    0    0    2   24  910    2]
 [   0    0    0    2    0    0    1    0    0    1   63]]
----------
Epoch Time: 1:31
====================================================================================================
Epoch 7/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:14<00:00, 22.30it/s, Loss=0.644802, Corrects=27/32, Accuracy=84.375%] 
Calculating metrics...
train loss: 0.404345, acc: 0.866227, f05_macro: 0.813490, f1_macro: 0.794318
Confusion matrix:
[[  277     6     2    60     5    45     0     1   110    27     5]
 [    1 11940   328    19    15   531     2    18    11    17     0]
 [    0   776  6297     2    35   365     0     6   108    36     1]
 [   50   138     6   413     1   158     9     9    29     2     2]
 [   10    86    62     5   428    66     2     1    15    14    10]
 [   25   970   283    64    20  6456     1     5   609    91     0]
 [    0     9     2    14     0     4   305   147     2     1    19]
 [    0    38     3    13     0     4    72  5349     1     4     1]
 [   39    31    54     9     1   466     1     8  5983   399     0]
 [   12    19    12     0     8    23     1     6   366  8006     2]
 [    1     2     1     9     8     1    14     0     2     2   560]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:21<00:00,  8.60it/s, Loss=0.347378, Corrects=17/21, Accuracy=80.952%] 
Calculating metrics...
test loss: 0.372901, acc: 0.878321, f05_macro: 0.829284, f1_macro: 0.812847
Confusion matrix:
[[  38    0    0    3    1    7    0    0    8    3    0]
 [   1 1355   38    1    6   22    0    1    2    5    1]
 [   0   64  738    0    1   16    0    1   27    2    0]
 [   4   19    1   42    0   16    3    0    7    0    0]
 [   0    7    5    0   57    4    0    0    0    4    1]
 [   2  131   27   12    1  694    0    0   73    8    0]
 [   0    3    0    2    0    1   34   13    0    0    3]
 [   0    5    0    3    0    0    7  595    0    0    0]
 [   4    1    2    0    0   43    1    1  695   30    0]
 [   1    3    0    0    0    0    0    2   54  880    0]
 [   1    0    0    2    0    0    1    0    0    1   62]]
----------
Epoch Time: 1:36
====================================================================================================
Epoch 8/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:10<00:00, 23.40it/s, Loss=0.275345, Corrects=29/32, Accuracy=90.625%] 
Calculating metrics...
train loss: 0.390292, acc: 0.870896, f05_macro: 0.821795, f1_macro: 0.803872
Confusion matrix:
[[  306     5     2    54     2    40     0     1   107    22     1]
 [    0 11979   292    21    22   506     2    22    15    23     0]
 [    0   752  6376     0    28   323     0     8   121    23     1]
 [   49   145     3   426     2   151    11    10    19     1     2]
 [    9    80    67     4   443    54     3     0    14    12    13]
 [   28   914   296    61    24  6494     2     3   599   101     0]
 [    0    10     1    13     1     6   309   144     0     0    18]
 [    0    34     4    10     1     9    75  5342     4     2     1]
 [   35    27    72    10     4   477     2     9  5988   367     1]
 [    5    21    21     0     2    24     0     6   329  8039     3]
 [    5     2     1     6     6     1    13     0     2     4   560]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:21<00:00,  8.76it/s, Loss=0.466318, Corrects=17/21, Accuracy=80.952%] 
Calculating metrics...
test loss: 0.414187, acc: 0.859367, f05_macro: 0.814568, f1_macro: 0.788243
Confusion matrix:
[[  38    0    0    3    1    3    0    0   12    3    0]
 [   0 1201   16    5    2  200    0    1    2    4    1]
 [   0   58  690    0    2   71    0    1   24    3    0]
 [   4   11    0   40    0   29    3    2    3    0    0]
 [   0   11    3    0   45   14    0    0    0    3    2]
 [   6   37    9    5    0  768    0    0  114    9    0]
 [   0    1    0    2    0    2   26   23    0    0    2]
 [   0    2    0    1    0    2    1  604    0    0    0]
 [   4    0    3    1    0   22    0    2  705   39    1]
 [   2    2    0    0    0    1    0    2   34  897    2]
 [   0    0    0    1    0    0    2    0    0    0   64]]
----------
Epoch Time: 1:32
====================================================================================================
Epoch 9/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:11<00:00, 23.33it/s, Loss=0.366183, Corrects=30/32, Accuracy=93.750%] 
Calculating metrics...
train loss: 0.381489, acc: 0.874793, f05_macro: 0.827996, f1_macro: 0.810009
Confusion matrix:
[[  296     7     2    58     3    58     0     1    91    21     3]
 [    0 12026   281    17    14   492     1    20    12    20     0]
 [    1   751  6366     4    31   334     0     4   114    26     1]
 [   52   130     0   433     1   151     8    18    22     2     0]
 [   12    71    59     3   461    57     3     0    15     9     9]
 [   27   906   284    62    16  6550     0     7   574    96     0]
 [    0     8     0    13     0     4   318   140     0     0    19]
 [    0    42     4     8     0     6    70  5346     3     4     1]
 [   32    29    59    10     3   446     2     8  6056   345     0]
 [    7    20    13     0     8    23     0     7   319  8051     3]
 [    2     2     1     9     7     2    10     0     0     1   566]]
 [   0    0    0    1    0    0    2    0    0    0   64]]
----------
Epoch Time: 1:32
====================================================================================================
Epoch 9/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:11<00:00, 23.33it/s, Loss=0.366183, Corrects=30/32, Accuracy=93.750%] 
Calculating metrics...
train loss: 0.381489, acc: 0.874793, f05_macro: 0.827996, f1_macro: 0.810009
Confusion matrix:
[[  296     7     2    58     3    58     0     1    91    21     3]
 [    0 12026   281    17    14   492     1    20    12    20     0]
 [    1   751  6366     4    31   334     0     4   114    26     1]
 [   52   130     0   433     1   151     8    18    22     2     0]
 [   12    71    59     3   461    57     3     0    15     9     9]
 [   27   906   284    62    16  6550     0     7   574    96     0]
 [    0     8     0    13     0     4   318   140     0     0    19]
 [    0    42     4     8     0     6    70  5346     3     4     1]
 [   32    29    59    10     3   446     2     8  6056   345     0]
 [    7    20    13     0     8    23     0     7   319  8051     3]
 [    2     2     1     9     7     2    10     0     0     1   566]]
====================================================================================================
Epoch 9/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:11<00:00, 23.33it/s, Loss=0.366183, Corrects=30/32, Accuracy=93.750%] 
Calculating metrics...
train loss: 0.381489, acc: 0.874793, f05_macro: 0.827996, f1_macro: 0.810009
Confusion matrix:
[[  296     7     2    58     3    58     0     1    91    21     3]
 [    0 12026   281    17    14   492     1    20    12    20     0]
 [    1   751  6366     4    31   334     0     4   114    26     1]
 [   52   130     0   433     1   151     8    18    22     2     0]
 [   12    71    59     3   461    57     3     0    15     9     9]
 [   27   906   284    62    16  6550     0     7   574    96     0]
 [    0     8     0    13     0     4   318   140     0     0    19]
 [    0    42     4     8     0     6    70  5346     3     4     1]
 [   32    29    59    10     3   446     2     8  6056   345     0]
 [    7    20    13     0     8    23     0     7   319  8051     3]
 [    2     2     1     9     7     2    10     0     0     1   566]]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:11<00:00, 23.33it/s, Loss=0.366183, Corrects=30/32, Accuracy=93.750%] 
Calculating metrics...
train loss: 0.381489, acc: 0.874793, f05_macro: 0.827996, f1_macro: 0.810009
Confusion matrix:
[[  296     7     2    58     3    58     0     1    91    21     3]
 [    0 12026   281    17    14   492     1    20    12    20     0]
 [    1   751  6366     4    31   334     0     4   114    26     1]
 [   52   130     0   433     1   151     8    18    22     2     0]
 [   12    71    59     3   461    57     3     0    15     9     9]
 [   27   906   284    62    16  6550     0     7   574    96     0]
 [    0     8     0    13     0     4   318   140     0     0    19]
 [    0    42     4     8     0     6    70  5346     3     4     1]
 [   32    29    59    10     3   446     2     8  6056   345     0]
 [    7    20    13     0     8    23     0     7   319  8051     3]
 [    2     2     1     9     7     2    10     0     0     1   566]]
Confusion matrix:
[[  296     7     2    58     3    58     0     1    91    21     3]
 [    0 12026   281    17    14   492     1    20    12    20     0]
 [    1   751  6366     4    31   334     0     4   114    26     1]
 [   52   130     0   433     1   151     8    18    22     2     0]
 [   12    71    59     3   461    57     3     0    15     9     9]
 [   27   906   284    62    16  6550     0     7   574    96     0]
 [    0     8     0    13     0     4   318   140     0     0    19]
 [    0    42     4     8     0     6    70  5346     3     4     1]
 [   32    29    59    10     3   446     2     8  6056   345     0]
 [    7    20    13     0     8    23     0     7   319  8051     3]
 [    2     2     1     9     7     2    10     0     0     1   566]]
 [   52   130     0   433     1   151     8    18    22     2     0]
 [   12    71    59     3   461    57     3     0    15     9     9]
 [   27   906   284    62    16  6550     0     7   574    96     0]
 [    0     8     0    13     0     4   318   140     0     0    19]
 [    0    42     4     8     0     6    70  5346     3     4     1]
 [   32    29    59    10     3   446     2     8  6056   345     0]
 [    7    20    13     0     8    23     0     7   319  8051     3]
 [    2     2     1     9     7     2    10     0     0     1   566]]
 [    0     8     0    13     0     4   318   140     0     0    19]
 [    0    42     4     8     0     6    70  5346     3     4     1]
 [   32    29    59    10     3   446     2     8  6056   345     0]
 [    7    20    13     0     8    23     0     7   319  8051     3]
 [    2     2     1     9     7     2    10     0     0     1   566]]
 [   32    29    59    10     3   446     2     8  6056   345     0]
 [    7    20    13     0     8    23     0     7   319  8051     3]
 [    2     2     1     9     7     2    10     0     0     1   566]]
--- Cur phase: test
 [    2     2     1     9     7     2    10     0     0     1   566]]
--- Cur phase: test
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:20<00:00,  8.84it/s, Loss=0.349854, Corrects=19/21, Accuracy=90.476%] 
Calculating metrics...
test loss: 0.383430, acc: 0.875444, f05_macro: 0.810185, f1_macro: 0.794425
Confusion matrix:
[[  34    0    0    5    1    2    0    0   13    5    0]
 [   1 1311   25   20    2   62    0    1    5    5    0]
 [   0   63  727    0    0   36    0    1   19    3    0]
 [   5   16    1   42    0   14    5    0    9    0    0]
 [   0   10   11    0   44    7    0    0    0    4    2]
 [   5   75   21   24    0  696    0    0  119    8    0]
 [   0    1    0    2    0    2   37   13    0    0    1]
 [   0    1    0    5    0    2    6  596    0    0    0]
 [   4    1    5    1    0   16    0    2  713   35    0]
 [   1    2    0    0    0    0    0    2   24  911    0]
 [   1    0    0    2    0    0    1    0    0    1   62]]
----------
Epoch Time: 1:32
====================================================================================================
Epoch 10/10
----------
--- Cur phase: train
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1660/1660 [01:06<00:00, 24.82it/s, Loss=0.177651, Corrects=29/32, Accuracy=90.625%] 
Calculating metrics...
train loss: 0.371139, acc: 0.877127, f05_macro: 0.829721, f1_macro: 0.813895
Confusion matrix:
[[  307     5     2    48     7    51     1     2    93    20     4]
 [    0 11984   307    31    26   482     1    14    14    23     0]
 [    0   720  6419     2    27   321     1     5   110    26     0]
 [   51   133     2   446     0   137    10    14    23     3     0]
 [   14    81    57     1   456    51     3     0    13     8    14]
 [   25   861   278    61    20  6576     2     5   604    90     0]
 [    0     8     1    13     0     5   335   125     0     0    16]
 [    0    35     5    10     1     4    71  5352     1     2     1]
 [   38    24    60     4     4   438     0    11  6062   350     0]
 [    9    23    17     0     2    26     0     3   276  8093     3]
 [    5     1     1     7     8     1    10     1     1     2   563]]
--- Cur phase: test
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 185/185 [00:22<00:00,  8.37it/s, Loss=0.313212, Corrects=20/21, Accuracy=95.238%] 
Calculating metrics...
test loss: 0.371602, acc: 0.882214, f05_macro: 0.837141, f1_macro: 0.812711
Confusion matrix:
[[  36    0    0    3    1    9    0    0    8    3    0]
 [   1 1346   20    0    3   57    0    0    2    3    0]
 [   0   78  711    0    2   40    0    0   15    3    0]
 [   5   22    1   35    0   21    4    0    4    0    0]
 [   0   11    3    0   51    8    0    0    0    4    1]
 [   5  105   14    1    0  773    0    0   44    6    0]
 [   0    2    0    2    0    3   38   10    0    0    1]
 [   0    8    0    1    0    1    8  592    0    0    0]
 [   4    4    3    0    0   73    1    0  659   33    0]
 [   2    5    0    0    0    3    0    1   20  909    0]
 [   0    0    0    2    0    0    1    0    0    1   63]]
----------
Epoch Time: 1:29
*** Training Completed ***
